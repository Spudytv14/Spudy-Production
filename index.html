<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spudy Library | Premium Learning</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js"></script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Playfair+Display:wght@700&display=swap');

        html, body {
            margin: 0;
            background: #050505;
            color: #f3f4f6;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            width: 100%;
            min-height: 100%;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Playfair Display', serif;
        }

        #canvas {
            width: 100vw;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            z-index: -1;
            pointer-events: none;
        }

        /* Premium Glow & Text Effects */
        .glow-text {
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.1);
        }

        .gold-text {
            background: linear-gradient(135deg, #38bdf8, #0ea5e9, #0284c7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0px 2px 10px rgba(14, 165, 233, 0.3);
        }

        /* Glassmorphism */
        .glass-nav {
            background: rgba(10, 10, 10, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .glass-card {
            background: rgba(20, 20, 20, 0.6);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.4s ease;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        .glass-card:hover {
            transform: translateY(-5px);
            border-color: rgba(14, 165, 233, 0.3);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
        }

        /* Badges */
        .badge {
            position: absolute;
            top: 12px;
            right: 12px;
            padding: 6px 14px;
            border-radius: 50px;
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            z-index: 10;
        }

        .badge-free {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        .badge-coming-soon {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .badge-popular {
            position: absolute;
            top: -14px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #38bdf8, #0ea5e9);
            color: black;
            padding: 6px 18px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 700;
            box-shadow: 0 4px 15px rgba(56, 189, 248, 0.4);
        }

        /* Buttons */
        .btn-premium {
            background: linear-gradient(135deg, #38bdf8, #0ea5e9);
            color: black;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(14, 165, 233, 0.2);
        }

        .btn-premium:hover {
            transform: scale(1.02);
            box-shadow: 0 6px 20px rgba(14, 165, 233, 0.4);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            transition: all 0.3s ease;
        }

        .btn-outline:hover {
            border-color: #38bdf8;
            color: #38bdf8;
        }

        /* Utilities */
        .counter-text {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
        }

        .payment-option { 
            transition: all 0.3s; 
            border: 1px solid rgba(255, 255, 255, 0.1); 
            cursor: pointer; 
        }
        .payment-option:hover { 
            transform: translateY(-5px); 
            border-color: #38bdf8;
            background: rgba(255, 255, 255, 0.03);
        }
        .payment-option.selected { 
            border-color: #10b981; 
            background: rgba(16, 185, 129, 0.1); 
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass-nav">
        <div class="max-w-7xl mx-auto flex justify-between items-center p-4">
            <h1 class="text-2xl font-bold gold-text tracking-wide">Spudy Library</h1>
            <div class="hidden md:flex items-center gap-6 text-sm font-medium">
                <a href="#home" class="text-gray-300 hover:text-white transition">Home</a>
                <a href="#spudy-books" class="text-gray-300 hover:text-white transition">Books</a>
                <a href="#spudy-courses" class="text-gray-300 hover:text-white transition">Courses</a>
                <a href="#pricing" class="text-gray-300 hover:text-white transition">Pricing</a>
                <button id="authBtn" onclick="openLogin()" class="btn-premium px-6 py-2 rounded-full text-sm">Login</button>
            </div>
            <!-- Mobile Menu Icon -->
            <button class="md:hidden text-gray-300 text-2xl focus:outline-none" onclick="toggleMobileMenu()">
                <i class="fas fa-bars"></i>
            </button>
        </div>

        <!-- Mobile Menu -->
        <div id="mobileMenu" class="hidden md:hidden absolute top-full left-0 w-full glass-nav border-t border-gray-800">
            <div class="flex flex-col p-6 space-y-4 text-center">
                <a href="#home" class="text-gray-300 hover:text-white transition py-2" onclick="toggleMobileMenu()">Home</a>
                <a href="#spudy-books" class="text-gray-300 hover:text-white transition py-2" onclick="toggleMobileMenu()">Books</a>
                <a href="#spudy-courses" class="text-gray-300 hover:text-white transition py-2" onclick="toggleMobileMenu()">Courses</a>
                <a href="#pricing" class="text-gray-300 hover:text-white transition py-2" onclick="toggleMobileMenu()">Pricing</a>
                <button onclick="openLogin(); toggleMobileMenu()" class="btn-premium px-6 py-2 rounded-full text-sm w-full">Login</button>
            </div>
        </div>
    </nav>

    <!-- Hero -->
    <section id="home" class="min-h-screen flex flex-col justify-center items-center text-center px-6 pt-20">
        <div class="max-w-4xl mx-auto" data-aos="fade-up">
            <h1 class="text-6xl md:text-8xl font-bold mb-6 tracking-tight text-white leading-tight">
                Welcome to <span class="gold-text">Spudy</span>
            </h1>
            <div class="h-16 mb-8">
                <span class="text-2xl md:text-4xl text-gray-400 font-light" id="typed"></span>
            </div>
            <div class="flex flex-col md:flex-row gap-6 justify-center">
                <a href="#spudy-books" class="btn-premium px-10 py-4 rounded-full text-lg shadow-lg">Explore Library</a>
                <a href="#spudy-courses" class="btn-outline px-10 py-4 rounded-full text-lg">View Courses</a>
            </div>
        </div>
    </section>

    <!-- FREE BOOKS -->
    <section id="spudy-books" class="py-32 px-6">
        <div class="max-w-7xl mx-auto">
            <h2 class="text-5xl font-bold text-center mb-4 text-white" data-aos="fade-up">Curated Collection</h2>
            <p class="text-center text-gray-400 mb-20 text-lg" data-aos="fade-up" data-aos-delay="100">Access our exclusive library of premium content</p>
            
            <div class="grid md:grid-cols-3 gap-10">
                <!-- Book 1 -->
                <div class="glass-card rounded-3xl p-8 relative group" data-aos="fade-up" data-aos-delay="200">
                    <div class="badge badge-free">Free Read</div>
                    <div class="relative overflow-hidden rounded-xl mb-8 shadow-2xl">
                        <img src="spudybook1.png" alt="Spudy Book 1" class="w-full object-cover transform group-hover:scale-105 transition duration-500">
                    </div>
                    <h3 class="text-2xl font-bold text-white mb-2">Chronicles of a Legend</h3>
                    <p class="text-gray-400 mb-8 text-sm leading-relaxed">A funny and inspiring high school adventure that captures the essence of youth.</p>
                    <button onclick="window.open('https://drive.google.com/file/d/12KQLWB37FYcVyzzM2raGUMBc1FBi0yD1/view?usp=drive_link','_blank')" 
                            class="w-full btn-premium py-4 rounded-xl text-lg flex items-center justify-center gap-2">
                        <i class="fas fa-book-open"></i> Read Now
                    </button>
                </div>

                <!-- Book 2 Coming Soon -->
                <div class="glass-card rounded-3xl p-8 relative opacity-75 hover:opacity-100 transition" data-aos="fade-up" data-aos-delay="300">
                    <div class="badge badge-coming-soon">Coming Soon</div>
                    <div class="relative overflow-hidden rounded-xl mb-8 shadow-2xl bg-gray-900 h-64 flex items-center justify-center border border-gray-800">
                        <i class="fas fa-lock text-5xl text-gray-700"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-white mb-2">Spudy Book 2</h3>
                    <p class="text-gray-400 mb-8 text-sm">The journey continues in this highly anticipated sequel.</p>
                    <button class="w-full bg-gray-800 text-gray-500 py-4 rounded-xl text-lg cursor-not-allowed">
                        Coming Soon
                    </button>
                </div>

                <!-- Book 3 Coming Soon -->
                <div class="glass-card rounded-3xl p-8 relative opacity-75 hover:opacity-100 transition" data-aos="fade-up" data-aos-delay="400">
                    <div class="badge badge-coming-soon">Coming Soon</div>
                    <div class="relative overflow-hidden rounded-xl mb-8 shadow-2xl bg-gray-900 h-64 flex items-center justify-center border border-gray-800">
                         <i class="fas fa-lock text-5xl text-gray-700"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-white mb-2">Spudy Book 3</h3>
                    <p class="text-gray-400 mb-8 text-sm">The epic finale that will leave you breathless.</p>
                    <button class="w-full bg-gray-800 text-gray-500 py-4 rounded-xl text-lg cursor-not-allowed">
                        Coming Soon
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- PREMIUM COURSES -->
    <section id="spudy-courses" class="py-32 px-6 bg-gradient-to-b from-transparent to-black/50">
        <div class="max-w-7xl mx-auto">
            <h2 class="text-5xl font-bold text-center mb-4 text-white" data-aos="fade-up">Elite Courses</h2>
            <p class="text-center text-gray-400 mb-20 text-lg" data-aos="fade-up" data-aos-delay="100">Master new skills with our expert-led programs</p>

            <div class="grid md:grid-cols-3 gap-8">
                <div class="glass-card p-10 rounded-3xl text-center group" data-aos="fade-up" data-aos-delay="200">
                    <div class="w-20 h-20 mx-auto bg-purple-900/30 rounded-full flex items-center justify-center mb-8 group-hover:bg-purple-600/20 transition">
                        <i class="fas fa-robot text-4xl text-purple-400"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-white mb-4">AI Fundamentals</h3>
                    <p class="text-gray-400 mb-8">From zero to AI hero in 8 weeks. Learn the future today.</p>
                    <button onclick="checkLogin()" class="btn-outline w-full py-3 rounded-xl">View Details</button>
                </div>
                <div class="glass-card p-10 rounded-3xl text-center group" data-aos="fade-up" data-aos-delay="300">
                    <div class="w-20 h-20 mx-auto bg-blue-900/30 rounded-full flex items-center justify-center mb-8 group-hover:bg-blue-600/20 transition">
                        <i class="fas fa-code text-4xl text-blue-400"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-white mb-4">Web Development</h3>
                    <p class="text-gray-400 mb-8">Build modern, responsive websites and applications.</p>
                    <button onclick="checkLogin()" class="btn-outline w-full py-3 rounded-xl">View Details</button>
                </div>
                <div class="glass-card p-10 rounded-3xl text-center group" data-aos="fade-up" data-aos-delay="400">
                    <div class="w-20 h-20 mx-auto bg-yellow-900/30 rounded-full flex items-center justify-center mb-8 group-hover:bg-yellow-600/20 transition">
                        <i class="fas fa-pen-nib text-4xl text-yellow-400"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-white mb-4">Creative Writing</h3>
                    <p class="text-gray-400 mb-8">Unleash your imagination and write your first bestseller.</p>
                    <button onclick="checkLogin()" class="btn-outline w-full py-3 rounded-xl">View Details</button>
                </div>
            </div>
        </div>
    </section>

    <!-- PRICING -->
    <section id="pricing" class="py-32 px-6">
        <div class="max-w-7xl mx-auto">
            <h2 class="text-5xl font-bold text-center mb-4 text-white" data-aos="fade-up">Membership</h2>
            <p class="text-center text-gray-400 mb-20 text-lg" data-aos="fade-up" data-aos-delay="100">Choose the plan that fits your ambition</p>

            <div class="grid md:grid-cols-3 gap-8 items-center">
                <!-- Free -->
                <div class="glass-card p-10 rounded-3xl" data-aos="fade-right">
                    <h3 class="text-xl font-bold text-gray-300">Starter</h3>
                    <p class="text-4xl font-bold text-white mt-4 mb-2">Free</p>
                    <p class="text-sm text-gray-500 mb-8">Forever</p>
                    <ul class="space-y-4 mb-10 text-gray-300 text-sm">
                        <li class="flex items-center gap-3"><i class="fas fa-check text-green-500"></i> Access to Free Books</li>
                        <li class="flex items-center gap-3"><i class="fas fa-check text-green-500"></i> Basic Community Access</li>
                    </ul>
                    <button class="w-full py-4 bg-gray-800 rounded-xl text-gray-400 font-bold" disabled>Current Plan</button>
                </div>

                <!-- Pro -->
                <div class="glass-card p-10 rounded-3xl border-t-4 border-yellow-500 relative transform md:scale-110 z-10 bg-gray-900/80" data-aos="fade-up">
                    <div class="badge badge-popular">MOST POPULAR</div>
                    <h3 class="text-xl font-bold text-white">Library Pro</h3>
                    <p class="text-5xl font-bold text-white mt-4 mb-2">$2.51</p>
                    <p class="text-sm text-gray-400 mb-8">per month</p>
                    <ul class="space-y-4 mb-10 text-gray-200">
                        <li class="flex items-center gap-3"><i class="fas fa-check text-yellow-500"></i> Unlimited Premium Books</li>
                        <li class="flex items-center gap-3"><i class="fas fa-check text-yellow-500"></i> Access to All Courses</li>
                        <li class="flex items-center gap-3"><i class="fas fa-check text-yellow-500"></i> Offline Reading Mode</li>
                    </ul>
                    <button onclick="selectPlan('Library Pro', 2.51)" class="w-full btn-premium py-4 rounded-xl text-lg">Upgrade Now</button>
                </div>

                <!-- Lifetime -->
                <div class="glass-card p-10 rounded-3xl" data-aos="fade-left">
                    <h3 class="text-xl font-bold text-gray-300">Lifetime</h3>
                    <p class="text-4xl font-bold text-white mt-4 mb-2">$49</p>
                    <p class="text-sm text-gray-500 mb-8">one-time payment</p>
                    <ul class="space-y-4 mb-10 text-gray-300 text-sm">
                        <li class="flex items-center gap-3"><i class="fas fa-check text-blue-500"></i> Everything in Pro</li>
                        <li class="flex items-center gap-3"><i class="fas fa-check text-blue-500"></i> Lifetime Updates</li>
                        <li class="flex items-center gap-3"><i class="fas fa-check text-blue-500"></i> VIP Support</li>
                    </ul>
                    <button onclick="selectPlan('Lifetime Access', 49)" class="w-full btn-outline py-4 rounded-xl font-bold">Get Lifetime</button>
                </div>
            </div>
        </div>
    </section>

    <!-- TRUSTED BY -->
    <section class="py-24 px-6 border-t border-gray-900">
        <div class="max-w-6xl mx-auto grid md:grid-cols-2 gap-16 items-center">
            <div>
                <h2 class="text-4xl font-bold mb-8">Trusted by thousands of students worldwide.</h2>
                <div class="grid grid-cols-2 gap-8">
                    <div>
                        <div class="counter text-4xl font-bold text-white mb-2" data-count="25000">0</div>
                        <p class="text-gray-500">Downloads</p>
                    </div>
                    <div>
                        <div class="counter text-4xl font-bold text-white mb-2" data-count="12000">0</div>
                        <p class="text-gray-500">Students</p>
                    </div>
                </div>
            </div>
            <div class="glass-card p-8 rounded-2xl relative">
                <i class="fas fa-quote-left text-4xl text-gray-700 absolute top-6 left-6"></i>
                <p class="text-lg text-gray-300 italic mb-6 relative z-10 pt-8">"Spudy Library changed how I learn. The quality of content is unmatched and the platform is so beautiful to use."</p>
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-gray-700 rounded-full"></div>
                    <div>
                        <p class="font-bold text-white">Nyasha K.</p>
                        <p class="text-sm text-gray-500">Computer Science Student</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CONTACT -->
    <section id="contact" class="py-24 px-6 bg-gradient-to-t from-black to-transparent">
        <h2 class="text-5xl font-bold text-center mb-16 text-white">Stay Connected</h2>
        <div class="max-w-2xl mx-auto text-center">
            <div class="glass-card p-10 rounded-3xl">
                <input type="email" id="subscribe-email" placeholder="Enter your email for updates" class="w-full p-4 bg-gray-800/50 border border-gray-700 rounded-xl mb-4 text-white focus:border-yellow-500 outline-none transition">
                <button onclick="submitSubscribe(event)" class="w-full py-4 btn-premium rounded-xl font-bold text-xl">Subscribe</button>
                <div id="subscribe-error" class="text-red-500 mt-2 hidden">Please enter a valid email</div>
            </div>
            <div class="mt-10 text-sm space-y-2 text-gray-500">
                <a href="https://spudytv14.github.io/Legai-Services/" target="_blank" class="hover:text-yellow-500 transition">Terms of Service</a> |
                <a href="#" class="hover:text-yellow-500 transition">Privacy Centre</a> |
                <a href="mailto:spudytv14@gmail.com" class="hover:text-yellow-500 transition">Have feedback? Let us know</a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="py-16 bg-black border-t border-gray-900">
        <div class="max-w-7xl mx-auto px-6 flex flex-col items-center">
            <h2 class="text-2xl font-bold gold-text mb-8">Spudy Library</h2>
            <div class="flex gap-8 text-2xl mb-8">
                <a href="https://api.whatsapp.com/send?phone=263716669706" target="_blank" class="text-gray-500 hover:text-white transition transform hover:scale-110"><i class="fab fa-whatsapp"></i></a>
                <a href="mailto:spudytv14@gmail.com" class="text-gray-500 hover:text-white transition transform hover:scale-110"><i class="fas fa-envelope"></i></a>
                <a href="https://facebook.com/matipaishe.blessing.muduchwa" target="_blank" class="text-gray-500 hover:text-white transition transform hover:scale-110"><i class="fab fa-facebook"></i></a>
                <a href="https://x.com/Matipa_14" target="_blank" class="text-gray-500 hover:text-white transition transform hover:scale-110"><i class="fab fa-x-twitter"></i></a>
                <a href="https://youtube.com/@SpudyAI" target="_blank" class="text-gray-500 hover:text-white transition transform hover:scale-110"><i class="fab fa-youtube"></i></a>
            </div>
            <p class="text-gray-600 text-sm">Â© 2026 Spudy Library. All Rights Reserved.</p>
        </div>
    </footer>

    <!-- Payment Modal -->
    <div id="paymentModal" class="fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center hidden z-50">
        <div class="glass-card p-8 rounded-3xl max-w-4xl w-full mx-4 relative overflow-y-auto max-h-[90vh]">
            <button onclick="closePayment()" class="absolute top-6 right-6 text-gray-500 hover:text-white text-xl">
                <i class="fas fa-times"></i>
            </button>
            
            <div class="text-center mb-10">
                <h2 class="text-3xl font-bold mb-2">Complete Payment</h2>
                <p class="text-gray-400">Upgrade to <span id="planName" class="text-white font-bold">Pro</span> for <span id="planPrice" class="text-yellow-500 font-bold">$2.51</span></p>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-8">
                <div class="payment-option p-4 rounded-xl text-center" onclick="selectPayment('EcoCash')">
                    <i class="fas fa-mobile-alt text-2xl mb-2 text-blue-400"></i>
                    <p class="font-bold text-sm">EcoCash</p>
                </div>
                <div class="payment-option p-4 rounded-xl text-center" onclick="selectPayment('Visa')">
                    <i class="fab fa-cc-visa text-2xl mb-2 text-white"></i>
                    <p class="font-bold text-sm">Visa</p>
                </div>
                 <div class="payment-option p-4 rounded-xl text-center" onclick="selectPayment('Mastercard')">
                    <i class="fab fa-cc-mastercard text-2xl mb-2 text-red-400"></i>
                    <p class="font-bold text-sm">Mastercard</p>
                </div>
                 <div class="payment-option p-4 rounded-xl text-center" onclick="selectPayment('OneMoney')">
                    <i class="fas fa-wallet text-2xl mb-2 text-orange-400"></i>
                    <p class="font-bold text-sm">OneMoney</p>
                </div>
                 <div class="payment-option p-4 rounded-xl text-center" onclick="selectPayment('PayPal')">
                    <i class="fab fa-paypal text-2xl mb-2 text-blue-600"></i>
                    <p class="font-bold text-sm">PayPal</p>
                </div>
            </div>

            <div id="paymentConfirm" class="hidden bg-gray-800/50 p-6 rounded-xl text-center">
                <p class="text-gray-300 mb-4">Pay with <span id="selectedMethod" class="text-white font-bold"></span></p>
                <button onclick="sendWhatsAppReceipt()" class="btn-premium w-full py-3 rounded-lg font-bold">
                    <i class="fab fa-whatsapp mr-2"></i> Confirm on WhatsApp
                </button>
            </div>
        </div>
    </div>

    <!-- Login Modal Placeholder -->
    <div id="loginModal" class="fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center hidden z-50">
        <div class="glass-card p-8 rounded-3xl max-w-md w-full mx-4 relative">
             <button onclick="closeLogin()" class="absolute top-6 right-6 text-gray-500 hover:text-white text-xl">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="text-2xl font-bold mb-6 text-center">Welcome Back</h2>
            <input type="email" placeholder="Email Address" class="w-full bg-gray-800 border border-gray-700 text-white p-4 rounded-xl mb-4 focus:border-yellow-500 outline-none transition">
            <input type="password" placeholder="Password" class="w-full bg-gray-800 border border-gray-700 text-white p-4 rounded-xl mb-6 focus:border-yellow-500 outline-none transition">
            <button class="w-full btn-premium py-4 rounded-xl font-bold mb-4">Login</button>
            <p class="text-center text-gray-500 text-sm">Don't have an account? <a href="#" class="text-white hover:underline">Sign up</a></p>
        </div>
    </div>

    <script>
        // Mobile Menu Logic
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('hidden');
        }

        // Login Logic
        let selectedPlan = '', selectedPrice = '', selectedMethod = '';

        if (localStorage.getItem('spudyLoggedIn') === 'true') {
            const authBtn = document.getElementById('authBtn');
            if (authBtn) authBtn.textContent = 'Account';
        }

        function openLogin() { 
            document.getElementById('loginModal').classList.remove('hidden'); 
        }

        function closeLogin() { 
            document.getElementById('loginModal').classList.add('hidden'); 
        }

        function checkLogin() { 
            if (localStorage.getItem('spudyLoggedIn') !== 'true') { 
                alert('Please login to continue!'); 
                openLogin(); 
            } else { 
                alert('Application submitted successfully!'); 
            } 
        }

        // Subscription Logic
        function submitSubscribe(event) {
            const email = document.getElementById('subscribe-email').value;
            const error = document.getElementById('subscribe-error');
            if (email && email.includes('@')) {
                error.classList.add('hidden');
                alert('Thank you for subscribing!');
            } else {
                error.classList.remove('hidden');
            }
        }

        // Payment Logic
        function selectPlan(name, price) {
            if (localStorage.getItem('spudyLoggedIn') !== 'true') { 
                alert('Please login first!'); 
                openLogin(); 
                return; 
            }
            selectedPlan = name; 
            selectedPrice = price;
            document.getElementById('planName').textContent = name;
            document.getElementById('planPrice').textContent = price === 49 ? '$49 Lifetime' : '$' + price + '/month';
            document.getElementById('paymentModal').classList.remove('hidden');
            document.getElementById('paymentConfirm').classList.add('hidden');
            document.querySelectorAll('.payment-option').forEach(el => el.classList.remove('selected'));
        }

        function selectPayment(method) {
            selectedMethod = method;
            document.querySelectorAll('.payment-option').forEach(el => el.classList.remove('selected'));
            // Find the element that called this function - tricky in global scope, let's fix in HTML
            // We will assume the event is passed or handled via binding, but for now let's use the old way
            // or rely on event.currentTarget if called from inline.
            // Since I'm moving to a file, I should probably attach listeners, but to keep compatibility with
            // the existing inline onclicks, I'll use event.currentTarget.
            if(event && event.currentTarget) event.currentTarget.classList.add('selected');
            
            document.getElementById('selectedMethod').textContent = method;
            document.getElementById('paymentConfirm').classList.remove('hidden');
        }

        function sendWhatsAppReceipt() {
            const msg = `Hi Spudy Library! I just paid $${selectedPrice} for ${selectedPlan} using ${selectedMethod}. Please activate my account!`;
            window.open(`https://api.whatsapp.com/send?phone=263716669706&text=${encodeURIComponent(msg)}`, '_blank');
        }

        function closePayment() { 
            document.getElementById('paymentModal').classList.add('hidden'); 
        }

        // Animated Counters
        const counters = document.querySelectorAll('.counter');

        function animateCounters() {
            const triggerBottom = window.innerHeight * 0.9;
            
            counters.forEach(counter => {
                if (counter.classList.contains('animated-started')) return;

                const counterTop = counter.getBoundingClientRect().top;
                
                // Trigger if the element is visible or has been scrolled past
                if (counterTop < triggerBottom) {
                    counter.classList.add('animated-started');
                    
                    const updateCounter = () => {
                        const target = +counter.getAttribute('data-count');
                        const c = +counter.innerText.replace(/,/g, '').replace('+', ''); // Clean current value
                        
                        // Dynamic increment based on target size to ensure quick animation
                        const increment = target / 50; 

                        if (c < target) {
                            counter.innerText = `${Math.ceil(c + increment).toLocaleString()}+`;
                            setTimeout(updateCounter, 30);
                        } else {
                            counter.innerText = `${target.toLocaleString()}+`;
                        }
                    };
                    updateCounter();
                }
            });
        }

        window.addEventListener('scroll', animateCounters);
        
        // Initial check in case elements are already in view
        document.addEventListener('DOMContentLoaded', animateCounters);

        // Three.js Background - Subtle Particles
        const initThreeJS = () => {
            const canvas = document.getElementById('canvas');
            if (!canvas) return;

            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true });
            
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);

            // Particles
            const particlesGeometry = new THREE.BufferGeometry();
            const particlesCount = 700;
            const posArray = new Float32Array(particlesCount * 3);

            for(let i = 0; i < particlesCount * 3; i++) {
                posArray[i] = (Math.random() - 0.5) * 50; // Spread
            }

            particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));

            const material = new THREE.PointsMaterial({
                size: 0.05,
                color: 0x38bdf8, // Light Blue
                transparent: true,
                opacity: 0.8,
            });

            const particlesMesh = new THREE.Points(particlesGeometry, material);
            scene.add(particlesMesh);

            camera.position.z = 20;

            // Mouse interaction
            let mouseX = 0;
            let mouseY = 0;

            document.addEventListener('mousemove', (event) => {
                mouseX = event.clientX;
                mouseY = event.clientY;
            });

            const animate = () => {
                requestAnimationFrame(animate);
                particlesMesh.rotation.y += 0.001;
                particlesMesh.rotation.x += 0.0005;

                // Subtle interactive movement
                particlesMesh.rotation.x += mouseY * 0.00005;
                particlesMesh.rotation.y += mouseX * 0.00005;

                renderer.render(scene, camera);
            };

            animate();

            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            AOS.init({
                duration: 1000,
                once: true,
                offset: 100
            });
            
            initThreeJS();
            
            // Typed.js
            if (document.getElementById('typed')) {
                new Typed('#typed', { 
                    strings: ["Read Premium Books", "Master New Skills", "Join the Elite", "Spudy Library"], 
                    typeSpeed: 60, 
                    backSpeed: 40, 
                    loop: true,
                    showCursor: false
                });
            }
        });
    </script>
</body>
</html>
